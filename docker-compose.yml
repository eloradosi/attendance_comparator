version: "3.8"

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      # No build args needed - all config loaded at runtime
    image: attendance-comparator:latest
    container_name: attendance-comparator
    ports:
      - "3000:3000"
    environment:
      # Runtime environment variables - read by /api/runtime-config
      # API Configuration
      API_URL: ${API_URL}

      # Firebase Web SDK Configuration (runtime only)
      FIREBASE_WEB_API_KEY: ${FIREBASE_WEB_API_KEY}
      FIREBASE_WEB_AUTH_DOMAIN: ${FIREBASE_WEB_AUTH_DOMAIN}
      FIREBASE_WEB_PROJECT_ID: ${FIREBASE_WEB_PROJECT_ID}
      FIREBASE_WEB_STORAGE_BUCKET: ${FIREBASE_WEB_STORAGE_BUCKET}
      FIREBASE_WEB_MESSAGING_SENDER_ID: ${FIREBASE_WEB_MESSAGING_SENDER_ID}
      FIREBASE_WEB_APP_ID: ${FIREBASE_WEB_APP_ID}
      FIREBASE_WEB_MEASUREMENT_ID: ${FIREBASE_WEB_MEASUREMENT_ID}

      # Firebase Admin SDK Configuration (server-side only)
      FIREBASE_ADMIN_PROJECT_ID: ${FIREBASE_ADMIN_PROJECT_ID}
      FIREBASE_ADMIN_CLIENT_EMAIL: ${FIREBASE_ADMIN_CLIENT_EMAIL}
      FIREBASE_ADMIN_PRIVATE_KEY: ${FIREBASE_ADMIN_PRIVATE_KEY}
      FIREBASE_ADMIN_CLIENT_ID: ${FIREBASE_ADMIN_CLIENT_ID}
    restart: unless-stopped
    # Uncomment jika ingin lihat logs
    # logging:
    #   driver: "json-file"
    #   options:
    #     max-size: "10m"
    #     max-file: "3"
